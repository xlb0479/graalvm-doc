# 本地镜像基础

本地镜像工具是用Java写的，它以Java字节码作为输入，以独立二进制文件作为输出（**可执行文件**或**共享库**）。生成二进制的过程中，它可以运行用户代码。最终，本地镜像工具会将编译后的用户代码、运行时的部分程序（比如垃圾回收以及线程底座）、以及代码执行结果链接起来打入二进制中。

我们把这种二进制称为**本地可执行文件**或**本地镜像**，把生成二进制的工具称为`native-image`**构造器**或`native-image`**生成器**。

为了区分本地镜像在构建时和运行时所执行的代码，我们把二者区分为[构建时和运行时](#构建时和运行时)。

为了将生成的镜像最小化，需要采用[静态分析](#静态分析)。

## 构建时和运行时

构建镜像的过程中，可能会执行一些用户代码。这种代码可能会有一些副作用，比如往一个类的静态属性中写个值啥的。我们说这种代码是运行在*构建时*。由这种代码写入到静态属性的值会被保存在[镜像堆](#本地镜像堆)中。*运行时*则是指二进制文件在执行时的代码和状态。



## 本地镜像堆

## 静态分析